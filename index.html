<!DOCTYPE html>
<html>
<head>
    <title>Roblox Web Clone</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #gui { position: absolute; top: 20px; left: 20px; color: white; background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; border: 2px solid #555; pointer-events: none; }
        #crosshair { position: absolute; top: 50%; left: 50%; width: 10px; height: 10px; border: 2px solid white; border-radius: 50%; transform: translate(-50%, -50%); }
    </style>
</head>
<body>
    <div id="gui">
        <h2 style="margin:0 0 10px 0; color: #f44336;">ROBLOX JS</h2>
        <b>WASD:</b> Hareket<br>
        <b>SPACE:</b> Zıpla<br>
        <b>MOUSE:</b> Bakış (Tıkla ve Kilitle)
    </div>
    <div id="crosshair"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // --- SAHNE VE AYARLAR ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x80aaff); // Klasik gökyüzü mavisi
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true; // Gölgeler!
        document.body.appendChild(renderer.domElement);

        // --- IŞIKLANDIRMA (Güneş gibi) ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);
        const sun = new THREE.DirectionalLight(0xffffff, 0.8);
        sun.position.set(50, 100, 50);
        sun.castShadow = true;
        scene.add(sun);

        // --- ROBLOX BASEPLATE (Meşhur Kareli Zemin) ---
        const textureLoader = new THREE.TextureLoader();
        // Basit bir kareli doku oluşturuyoruz
        const floorGeo = new THREE.PlaneGeometry(200, 200);
        const floorMat = new THREE.MeshPhongMaterial({ color: 0x3b3b3b }); // Klasik koyu gri baseplate
        const floor = new THREE.Mesh(floorGeo, floorMat);
        floor.rotation.x = -Math.PI / 2;
        floor.receiveShadow = true;
        scene.add(floor);

        // Izgara (Grid) - Tam Roblox havası verir
        const grid = new THREE.GridHelper(200, 40, 0x555555, 0x444444);
        scene.add(grid);

        // --- KARAKTER (R6 Tipi Roblox Karakteri) ---
        const playerGroup = new THREE.Group();
        scene.add(playerGroup);

        function createPart(w, h, d, color, x, y, z) {
            const geo = new THREE.BoxGeometry(w, h, d);
            const mat = new THREE.MeshPhongMaterial({ color: color });
            const part = new THREE.Mesh(geo, mat);
            part.position.set(x, y, z);
            part.castShadow = true;
            return part;
        }

        const torso = createPart(1, 1.2, 0.5, 0x0055ff, 0, 1.6, 0); // Gövde (Mavi)
        const head = createPart(0.6, 0.6, 0.6, 0xffcc00, 0, 2.6, 0); // Kafa (Sarı)
        const lArm = createPart(0.5, 1.2, 0.5, 0xffcc00, -0.8, 1.6, 0); // Sol Kol
        const rArm = createPart(0.5, 1.2, 0.5, 0xffcc00, 0.8, 1.6, 0); // Sağ Kol
        const lLeg = createPart(0.5, 1.2, 0.5, 0x333333, -0.25, 0.6, 0); // Sol Bacak
        const rLeg = createPart(0.5, 1.2, 0.5, 0x333333, 0.25, 0.6, 0); // Sağ Bacak

        playerGroup.add(torso, head, lArm, rArm, lLeg, rLeg);

        // Kamera Takibi
        const cameraOffset = new THREE.Vector3(0, 5, 10);
        
        // --- FİZİK VE HAREKET DEĞİŞKENLERİ ---
        let velocityY = 0;
        let isJumping = false;
        const gravity = -0.015;
        const jumpForce = 0.4;
        const speed = 0.2;
        let yaw = 0, pitch = 0;

        // Kontroller
        const keys = {};
        window.addEventListener('keydown', (e) => keys[e.code] = true);
        window.addEventListener('keyup', (e) => keys[e.code] = false);
        document.body.addEventListener('click', () => document.body.requestPointerLock());

        document.addEventListener('mousemove', (e) => {
            if (document.pointerLockElement === document.body) {
                yaw -= e.movementX * 0.003;
                pitch -= e.movementY * 0.003;
                pitch = Math.max(-0.8, Math.min(0.5, pitch));
                playerGroup.rotation.y = yaw;
            }
        });

        // --- OYUN DÖNGÜSÜ ---
        function animate() {
            requestAnimationFrame(animate);

            // Yürüme
            if (keys['KeyW']) playerGroup.translateZ(-speed);
            if (keys['KeyS']) playerGroup.translateZ(speed);
            if (keys['KeyA']) playerGroup.translateX(-speed);
            if (keys['KeyD']) playerGroup.translateX(speed);

            // Zıplama ve Yerçekimi
            if (keys['Space'] && !isJumping) {
                velocityY = jumpForce;
                isJumping = true;
            }

            playerGroup.position.y += velocityY;
            velocityY += gravity;

            if (playerGroup.position.y <= 0) {
                playerGroup.position.y = 0;
                velocityY = 0;
                isJumping = false;
            }

            // Kamera takibi (Karakterin arkasından bakış)
            const relativeCameraOffset = new THREE.Vector3(0, 4, 8);
            const cameraOffset = relativeCameraOffset.applyMatrix4(playerGroup.matrixWorld);
            camera.position.x = cameraOffset.x;
            camera.position.y = cameraOffset.y;
            camera.position.z = cameraOffset.z;
            camera.lookAt(playerGroup.position.x, playerGroup.position.y + 2, playerGroup.position.z);

            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>